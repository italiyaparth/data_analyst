Sub Macro4()
    Dim tbl As Table
    Dim cellText As String
    Dim navDate As String
    Dim rngInsert As Range
    Dim pageWidth As Single
    Dim filePath As String
    Dim foundRange As Range
    Dim colNum As Integer
    
    ' Define the table containing the text
    Set tbl = ActiveDocument.Tables(1) ' Change 1 to the index of your table if it's not the first table
    
    Dim searchValue As String
    
    ' Set the value to search for
    searchValue = "NAV Date"
    
    ' Use Find method to search for the text within the table
    Set foundRange = tbl.Range
    With foundRange.Find
        .Text = searchValue
        If .Execute Then
            ' Get the column number of the found range
            colNum = foundRange.Cells(1).ColumnIndex
        Else
            ' If the search text is not found in the table
            MsgBox "The text '" & searchText & "' is not found in the table."
        End If
    End With
    
    navDate = tbl.cell(3, colNum).Range.Text
    navDate = Trim(navDate)
    
    navDate = Replace(navDate, vbCr, "")
    navDate = Replace(navDate, vbLf, "")
    navDate = Replace(navDate, vbTab, "")
    navDate = Replace(navDate, vbCrLf, "")
    
    
    Dim regEx As Object
    
    ' Create a regular expression object
    Set regEx = CreateObject("VBScript.RegExp")
    
    ' Define the pattern to match non-printable characters (ASCII 0-31 and 127)
    regEx.Pattern = "[\x00-\x1F\x7F]"
    
    ' Replace non-printable characters with an empty string
    navDate = regEx.Replace(navDate, "")
    
    ' Get the text from the specified cell (3rd row, 2nd column)
    cellText = tbl.cell(3, 2).Range.Text
    cellText = Trim(cellText)
    
    ' Remove any extra characters (such as paragraph marks) from the text
    cellText = Replace(cellText, vbCr, "")
    cellText = Replace(cellText, vbLf, "")
    cellText = Replace(cellText, vbTab, "")
    cellText = Replace(cellText, vbCrLf, "")
    
    
    ' Create a regular expression object
    Set regEx = CreateObject("VBScript.RegExp")
    
    ' Define the pattern to match non-printable characters (ASCII 0-31 and 127)
    regEx.Pattern = "[\x00-\x1F\x7F]"
    
    ' Replace non-printable characters with an empty string
    cellText = regEx.Replace(cellText, "")
    
    Dim fileName As String
    
    ' Generate the custom string (you can modify this part as needed)
    fileName = cellText & " - Mutual Fund Valuation Report as on Date " & navDate
    
    
    ' Append additional text with a new line
    cellText = cellText & vbCrLf & "Valuation Report as on Date- " & navDate
    

    With ActiveDocument
        .Paragraphs(5).Range.InsertBefore cellText
    End With
    
    
    ' Calculate the width of the page
    pageWidth = ActiveDocument.PageSetup.pageWidth
    
    ' Set the table alignment to center
    tbl.Rows.Alignment = wdAlignRowCenter
    
    ' Set the table width to autofit window
    tbl.AutoFitBehavior (wdAutoFitWindow)
        
    
    filePath = "D:\MY WORK\2024-2025 VALUATION REPORT\New Folder\"
    
    ' Save the Word document with the generated name
    ActiveDocument.SaveAs fileName:=filePath & fileName & ".docx", FileFormat:=wdFormatDocumentDefault
    
            
End Sub
