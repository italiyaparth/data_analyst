let
    Source = Folder.Files(Path),
    #"Custom M Language Formula" = Table.TransformColumns(Source, {"Content", each Excel.Workbook(_, true)}),
    #"Expanded Content" = Table.ExpandTableColumn(#"Custom M Language Formula", "Content", {"Name", "Data", "Item", "Kind", "Hidden"}, {"Name.1", "Data", "Item", "Kind", "Hidden"}),
    #"Filtered Files" = Table.SelectRows(#"Expanded Content", each ([Hidden] = false)),
    #"Custom M Language Formula to Add File Names" = Table.AddColumn(#"Filtered Files", "DataWithFileName", each Table.AddColumn([Data], "FileName", (row) => [Name])),
    #"Custom M Language Formula to Combine Data" = Table.Combine(#"Custom M Language Formula to Add File Names"[DataWithFileName]),
    #"Filtered Rows" = Table.SelectRows(#"Custom M Language Formula to Combine Data", each ([Shape] <> null and [Shape] <> ""))
in
    #"Filtered Rows"






-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------



for DATE from "20251231" file name format


Text.Middle([FileName],6,2) & "-" & Text.Middle([FileName],4,2) & "-" & Text.Start([FileName],4)